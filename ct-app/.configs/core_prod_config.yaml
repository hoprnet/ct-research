---
# =============================================================================
# 
# =============================================================================
environment: prod

flags:
  core: 
    apply_economic_model: 30
    ticket_parameters: 60

    connected_peers: 30
    topology: 30

    rotate_subgraphs: 60
    open_sessions: 60

    peers_rewards: 300
    registered_nodes: 300
    allocations: 300
    eoa_balances: 300
    nft_holders: 300
    safe_fundings: 300
    
  node:
    healthcheck: 15
    retrieve_peers: 60
    retrieve_channels: 120
    retrieve_balances: 300

    open_channels: 300
    fund_channels: 300
    close_old_channels: 300
    close_pending_channels: 300
    close_incoming_channels: Off

    get_total_channel_funds: 300
    
    observe_message_queue: On # should only be On / Off
    close_sessions: 30

  peer:
    message_relay_request: On # should only be On / Off

# =============================================================================
# 
# =============================================================================
economic_model:
  min_safe_allowance: -1
  nft_threshold: 30000

  legacy:
    proportion: 1.0
    apr: 12.5

    coefficients:
      a: 1
      b: 1.4
      c: 75000
      l: 10000
    
    equations: 
      fx: 
        formula: "a * x"
        condition: "l <= x <= c"
      gx:
        formula: "a * c + (x - c) ** (1 / b)"
        condition: "x > c"

  sigmoid:
    proportion: 0
    max_apr: 15
    network_capacity: 2000
    total_token_supply: 450000000

    offset: -0.9
    buckets:
      economic_security:
        flatness: 1.8
        skewness: 1.52
        upperbound: 0.4
        offset: 3.14

      network_capacity:
        flatness: 2.97
        skewness: 0.72
        upperbound: 1.0
        offset: 4.08

# =============================================================================
# 
# =============================================================================
peer:
  min_version: '2.2.1'
  sleep_mean_time: 30
  sleep_std_time: 2
  # Controls how many messages are batched at a time. Increasing this reduces
  # the queue size but also privacy as the load gets less spread over time. 
  # NOTE: Should be replaced by a dynamic approch, by setting the minimum delay
  # acceptable before increasing the batch size accordingly (auto-mode)
  message_multiplier: 1

# =============================================================================
# 
# =============================================================================
channel:
  min_balance: 20
  funding_amount: 30
  max_age_seconds: 172800
  
# =============================================================================
# 
# =============================================================================
sessions:
  packetSize: 462 # TODO 3.0: change to 762
  aggregatedPackets: 10
  batchSize: 5

# =============================================================================
# 
# =============================================================================
fundings:
  constant: 626500
  
# =============================================================================
# 
# =============================================================================
subgraph:
  type: auto # auto | default | backup
  user_id: 78696

  mainnet_allocations:
    query_id: FhU1GxUovoP1zphNbWFEQHwpabLGELQBdWWyFX1yjBkf
    slug: hopr-allocations
    inputs:
      schedule_in:
        - investor-node-remainder-2024-01
  gnosis_allocations:
    query_id: DXy4UwhNms3zm7abYeSYaD3hTkuaWYyNvozrXSXejMbS
    slug: hopr-allocations---gnosis
    inputs:
      schedule_in:
        - investor-node-remainder-2024-01
  hopr_on_mainnet:
    query_id: 4GZdwVtPcQp95RF77W27GK2ezgGLB1iintG6mYZQ1w33
    slug: hopr---mainnet
  hopr_on_gnosis:
    query_id: 2wMRp1AW1ghxoFiM6WeRD93djHNvNGhXsuQyadmwCyqE
    slug: hopr-on-gnosis
  fundings:
    query_id: EpAdSFzDLT7N5RhA3UxtqGUwkFxmMunSE2yGLb8juQjC
    slug: subgraph-wxhopr-txs
    inputs:
      from: '0xd9a00176cf49dfb9ca3ef61805a2850f45cb1d05'
  rewards:
    query_id: GoJ4KRuYEcELQk42hir2tjau6r1u4ibDFY6t1zH6zpKk
    slug: hopr-channels
  safes_balance:
    query_id: GP2abJCarirMJCanuk4SBmnadiobEWH9ME2MNRAHbBTp
    slug: hopr-nodes-dufour
  staking:
    query_id: F1NZayy7TXRi2szAVXvMFfJuC9uSdNYLUPAb6p6BYRmZ
    slug: hopr-stake-all-seasons
...